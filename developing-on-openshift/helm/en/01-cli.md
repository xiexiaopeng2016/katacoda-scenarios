At the end of this chapter you will be able to:
- Use `helm` CLI
- Install `helm repository`
- Search, install and uninstall `Helm Charts`
- Review Helm Charts from `OpenShift Console`

## HelmÂ Command Line Interface (CLI)

In this scenario you will find the Helm CLI already installed for you, which can be  also retrieved from OpenShift Console, top right corner, click on ? -> Command Line Tools.

The CLI is the entry point for any interaction with Helm 3 subsystem. In addition to that, OpenShift Developer Catalog, which is the central hub for all developer content, has support for Helm Charts in addition to Operator-backed services, Templates, etc.

When a user instructs the Helm CLI to install a Helm Chart, the information about the Helm Chart is fetched from the repository, rendered on the client and then applied to Kubernetes while a record of this installation is created within the namespace (which is known as a Release).

![Helm on OpenShift](../../assets/developing-on-openshift/helm/helm-diagram.png)


## Logging in to the Cluster

To login to the OpenShift cluster from the Terminal run:

`oc login -u developer -p developer`{{execute}}

This will log you in using the credentials:

* **Username:** ``developer``{{copy}}
* **Password:** ``developer``{{copy}}

Use the same credentials to log into the Web Console.

Create a new OpenShift Project to have a namespace for our  helm charts to work with.

`oc new-project helm`{{execute}}

## Exercise: Explore CLI
Let's get started by using `helm` getting CLI version :

`helm version`{{execute}}

This should confirm we are using **Helm 3**.

As discussed in the previous step, Helm Charts are available through repositories, and those can be pre-installed or installable by the user.

You can search for Helm Charts available in any public repositories through [Helm Hub](https://hub.helm.sh/).

For instance, searching Helm Charts for [NGINX](https://nginx.com):

`helm search hub nginx`{{execute}}

This will give a list of available charts from multiple repositories. If we want to install it, we need to have such repositories configured.


By default the list of available repositories is empty. You can add a new one with the CLI. For NGINX, add Bitnami repository:

`helm repo add bitnami https://charts.bitnami.com/bitnami`{{execute}}

Once added, verify it is present:

`helm repo list`{{execute}}

You can search for Helm Charts also inside repos, like in the one you just installed:

`helm search repo bitnami/nginx`{{execute}}

## Deploy a Helm Chart

You can use `helm install` command to deploy your charts and start managing revisions.
 
To install [NGINX Chart](https://hub.helm.sh/charts/bitnami/nginx):

`helm install my-nginx bitnami/nginx --set service.type=ClusterIP`{{execute}}

This will install `nginx`, and for this example, we want to use `ClusterIP` Service type because we want to expose it afterwards through an OpenShift `Route`.

Check your Helm releases:

`helm ls`{{execute}}

Verify all the pods are in Running state and Ready:

`oc get pods`{{execute}}

Now expose `my-nginx` service to access it via OpenShift `Route`:

`oc expose svc/my-nginx`{{execute}}

Verify that route has been created:

`oc get routes`{{execute}}

You can click on the generated host to access the NGINX Pod provided by your just installed Helm Chart, or you can do it from OpenShift Console.

## Verify the deployment from OpenShift Console

To verify the creation of the resources generated by the Helm Chart, you can head out to the OpenShift web console.

You can make your way to the web console by clicking on the Console tab next to the Terminal tab at the center top of the workshop in your browser.

You need to log in with username `developer` and password `developer`.

Make sure the Developer perspective from the dropdown in the top left corner of the web console is selected as shown below:

<img src="../../assets/middleware/pipelines/developer-view.png" width="800" />

Next, select the Project dropdown menu shown below and choose `helm` project you have been working with.

Next, click on the Topology tab on the left side of the web console if you don't see what's in the image below. Once in the Topology view, you can see the Deployment for `my-nginx` application and you can access it by clicking on the URL generated by the OpenShift Route:

<img src="../../assets/developing-on-openshift/helm/nginx-helm-chart-route.png" width="800" />

You'll notice the HR label and Helm icon below, this means that this application is managed by Helm, and you can overview Helm `Releases` for this app from left side menu, Helm section:

<img src="../../assets/developing-on-openshift/helm/nginx-helm-releases.png" width="800" />

Explore all `Resources` that are associated with a particular Helm `Release`, click on `my-nginx` Helm Release and then click on `Resouces` tab:

<img src="../../assets/developing-on-openshift/helm/nginx-helm-resources-view.png" width="800" />


# Uninstall and clean

Come back to Terminal clicking on Terminal tab.

Uninstall `my-nginx` release:

`helm uninstall my-nginx`{{execute}}

Delete previously created `route`:

`oc delete route my-nginx`{{execute}}


















